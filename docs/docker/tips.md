# Docker - –°–æ–≤–µ—Ç—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞

### 1. **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π `-d` –¥–ª—è —Ñ–æ–Ω–∞**
```bash
# ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ - –∑–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
docker compose up -d

# ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ - –±–ª–æ–∫–∏—Ä—É–µ—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª
docker compose up
```

### 2. **–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –ø–µ—Ä–µ–¥ –≤—ã–∫–ª—é—á–µ–Ω–∏–µ–º Mac**
```bash
# –ü–µ—Ä–µ–¥ –≤—ã–∫–ª—é—á–µ–Ω–∏–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
docker compose down
```

### 3. **–†–µ–≥—É–ª—è—Ä–Ω–æ —á–∏—Å—Ç–∏ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ**
```bash
# –†–∞–∑ –≤ –Ω–µ–¥–µ–ª—é
docker system prune -a
```

## üéØ –¢–∏–ø–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞
```bash
cd qa-sentinel
docker compose up -d
```

### –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã –∫–∞–∂–¥—ã–π –¥–µ–Ω—å
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å—ë –∑–∞–ø—É—â–µ–Ω–æ
docker ps

# –ï—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
docker compose up -d
```

### –ö–æ–Ω–µ—Ü —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è
```bash
# –ú–æ–∂–µ—à—å –æ—Å—Ç–∞–≤–∏—Ç—å –∑–∞–ø—É—â–µ–Ω–Ω—ã–º –∏–ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
docker compose down
```

### –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ —Å–ª–æ–º–∞–ª–æ—Å—å
```bash
# –ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker compose down -v
docker compose up -d

# –ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ - –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –æ–±—Ä–∞–∑—ã
docker compose down -v
docker compose pull
docker compose up -d
```

### –ù—É–∂–Ω–æ –æ—Å–≤–æ–±–æ–¥–∏—Ç—å –º–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ
```bash
# –£–¥–∞–ª–∏—Ç—å –≤—Å—ë –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–µ
docker system prune -a --volumes
```

## üö® –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü–æ—Ä—Ç —É–∂–µ –∑–∞–Ω—è—Ç
```
Error: bind: address already in use
```

**–†–µ—à–µ–Ω–∏–µ**: –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—Ç –≤ `docker-compose.yml`
```yaml
ports:
  - "5433:5432"  # –í–º–µ—Å—Ç–æ 5432:5432
```

### –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
docker compose logs postgres

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å healthcheck
docker ps
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç–∞—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
**–ü—Ä–∏—á–∏–Ω–∞**: –£–¥–∞–ª–∏–ª volumes (`docker compose down -v`)

**–†–µ—à–µ–Ω–∏–µ**: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –±—ç–∫–∞–ø–∞
```bash
cat backup.sql | docker exec -i qa-sentinel-postgres psql -U postgres -d qa_sentinel
```

### Docker Desktop –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ**:
1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Docker Desktop
2. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å Mac
3. –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Docker Desktop

## üí° –ü–æ–ª–µ–∑–Ω—ã–µ —Ç—Ä—é–∫–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ Docker –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ Mac
Docker Desktop ‚Üí Settings ‚Üí General ‚Üí Start Docker Desktop when you log in

### –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
Docker Desktop ‚Üí Settings ‚Üí Resources:
- CPU: 4 cores
- Memory: 4 GB
- Swap: 1 GB
- Disk: 60 GB

### –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ –ª–æ–≥–∞–º
```bash
# –°–æ–∑–¥–∞–π alias –≤ ~/.zshrc
alias dlogs='docker compose logs -f --tail=50'

# –¢–µ–ø–µ—Ä—å –º–æ–∂–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
dlogs postgres
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±—ç–∫–∞–ø –±–∞–∑—ã
```bash
# –°–æ–∑–¥–∞–π —Å–∫—Ä–∏–ø—Ç backup.sh
#!/bin/bash
DATE=$(date +%Y%m%d_%H%M%S)
docker exec qa-sentinel-postgres pg_dump -U postgres qa_sentinel > "backups/backup_$DATE.sql"

# –ó–∞–ø—É—Å–∫–∞–π —Ä–∞–∑ –≤ –¥–µ–Ω—å
chmod +x backup.sh
./backup.sh
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö Docker

```
Docker —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –≤ volumes:
‚îú‚îÄ‚îÄ postgres_data/     # –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã –∏ –¥–∞–Ω–Ω—ã–µ PostgreSQL
‚îú‚îÄ‚îÄ redis_data/        # –î–∞–Ω–Ω—ã–µ Redis (–æ—á–µ—Ä–µ–¥–∏)
‚îî‚îÄ‚îÄ pgadmin_data/      # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ pgAdmin

–≠—Ç–∏ –¥–∞–Ω–Ω—ã–µ –ù–ï —É–¥–∞–ª—è—é—Ç—Å—è –ø—Ä–∏ `docker compose down`
–£–¥–∞–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ `docker compose down -v`
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- –ü—Ä–æ—Å—Ç—ã–µ –ø–∞—Ä–æ–ª–∏ (postgres/postgres) - **–û–ö**
- –û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã (5432, 6380) - **–û–ö**

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ (Vercel/Railway)
- –ò—Å–ø–æ–ª—å–∑—É–π —Å–∏–ª—å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏
- –ù–µ –æ—Ç–∫—Ä—ã–≤–∞–π –ø–æ—Ä—Ç—ã –Ω–∞—Ä—É–∂—É
- –ò—Å–ø–æ–ª—å–∑—É–π SSL –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ
- –ù–µ –∫–æ–º–º–∏—Ç—å `.env` —Ñ–∞–π–ª—ã –≤ git

## üéì –ß—Ç–æ –≤–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å

### Volumes vs Containers
- **Container** = –∑–∞–ø—É—â–µ–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (—É–¥–∞–ª—è–µ—Ç—Å—è –ø—Ä–∏ `down`)
- **Volume** = –¥–∞–Ω–Ω—ã–µ (—Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø—Ä–∏ `down`, —É–¥–∞–ª—è—é—Ç—Å—è –ø—Ä–∏ `down -v`)

### Images vs Containers
- **Image** = —à–∞–±–ª–æ–Ω (—Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑)
- **Container** = —ç–∫–∑–µ–º–ø–ª—è—Ä —à–∞–±–ª–æ–Ω–∞ (–º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –º–Ω–æ–≥–æ —Ä–∞–∑)

### Network
Docker —Å–æ–∑–¥–∞–µ—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é —Å–µ—Ç—å `qa-sentinel`:
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤–∏–¥—è—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –ø–æ –∏–º–µ–Ω–∏
- `postgres` –¥–æ—Å—Ç—É–ø–µ–Ω –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ç–∏ –∫–∞–∫ `postgres:5432`
- –°–Ω–∞—Ä—É–∂–∏ –¥–æ—Å—Ç—É–ø–µ–Ω –∫–∞–∫ `localhost:5432`

## üìö –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —á—Ç–æ

### `docker compose up -d`
–ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

### `docker compose down`
–û—Å—Ç–∞–Ω–æ–≤–∫–∞ (–¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è)

### `docker compose down -v`
–ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (–¥–∞–Ω–Ω—ã–µ —É–¥–∞–ª—è—é—Ç—Å—è)

### `docker compose restart`
–ë—ã—Å—Ç—Ä—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ (–±–µ–∑ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è)

### `docker compose logs -f`
–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
